# ðŸ· é…’é¡žè²¿æ˜“ç³»çµ± - åŠŸèƒ½æ¨¹ç‹€åœ–

## ðŸ“‹ æ ¸å¿ƒæ¥­å‹™æµç¨‹

```
é…’é¡žè²¿æ˜“ ERP ç³»çµ±
â”‚
â”œâ”€ ðŸ‘¥ äººå“¡ç®¡ç†
â”‚   â”œâ”€ User (ä½¿ç”¨è€…)
â”‚   â”‚   â”œâ”€ SUPER_ADMIN (è¶…ç´šç®¡ç†å“¡) - å…¨æ¬Šé™
â”‚   â”‚   â”œâ”€ EMPLOYEE (å“¡å·¥) - åŸºæœ¬ç‡Ÿé‹æ¬Šé™
â”‚   â”‚   â””â”€ INVESTOR (æŠ•è³‡æ–¹) - å—é™æŸ¥è©¢æ¬Šé™
â”‚   â”‚
â”‚   â””â”€ æ¬Šé™éš”é›¢æ©Ÿåˆ¶
â”‚       â””â”€ INVESTOR åªèƒ½çœ‹å…¬å¸è³‡é‡‘ (COMPANY) çš„æ•¸æ“š
â”‚
â”œâ”€ ðŸ“¦ æŽ¡è³¼ â†’ é€²è²¨æµç¨‹
â”‚   â”‚
â”‚   â”œâ”€ 1ï¸âƒ£ ã€æŽ¡è³¼å–®ã€‘Purchase
â”‚   â”‚   â”œâ”€ å»ºç«‹æŽ¡è³¼å–®
â”‚   â”‚   â”œâ”€ PurchaseItem (æŽ¡è³¼æ˜Žç´°)
â”‚   â”‚   â””â”€ ä¾›æ‡‰å•†è³‡è¨Š
â”‚   â”‚
â”‚   â”œâ”€ 2ï¸âƒ£ ã€é€²è²¨å–®ã€‘Import (v2 æ–°ç‰ˆ)
â”‚   â”‚   â”œâ”€ å¾žæŽ¡è³¼å–®å‰µå»ºé€²è²¨å–®
â”‚   â”‚   â”œâ”€ ImportItem (é€²è²¨æ˜Žç´°)
â”‚   â”‚   â”œâ”€ åŒ¯çŽ‡è¨­å®š (exchange_rate)
â”‚   â”‚   â”œâ”€ å ±é—œè³‡è¨Š
â”‚   â”‚   â”‚   â”œâ”€ å ±å–®è™Ÿç¢¼ (declaration_number)
â”‚   â”‚   â”‚   â”œâ”€ å ±é—œæ—¥æœŸ (declaration_date)
â”‚   â”‚   â”‚   â””â”€ æµ·é—œæŠ½é©—æ•¸é‡ (customs_seized)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€ è²»ç”¨è¨˜éŒ„ â†’ ImportCost
â”‚   â”‚   â”‚   â”œâ”€ SHIPPING (é‹è²»)
â”‚   â”‚   â”‚   â”œâ”€ INSPECTION (æª¢é©—è²»)
â”‚   â”‚   â”‚   â”œâ”€ STORAGE (å€‰å„²è²»)
â”‚   â”‚   â”‚   â”œâ”€ CUSTOMS (å ±é—œè²»)
â”‚   â”‚   â”‚   â””â”€ OTHER (å…¶ä»–)
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€ æˆæœ¬è¨ˆç®—
â”‚   â”‚       â”œâ”€ å•†å“æˆæœ¬ (total_value)
â”‚   â”‚       â”œâ”€ é—œç¨… (total_taxes)
â”‚   â”‚       â”œâ”€ é¡å¤–è²»ç”¨ (ImportCost ç¸½å’Œ)
â”‚   â”‚       â””â”€ æœ€çµ‚æˆæœ¬ = ä»¥ä¸Šä¸‰è€…åŠ ç¸½
â”‚   â”‚
â”‚   â”œâ”€ 3ï¸âƒ£ ã€æ”¶è²¨ã€‘POST /api/imports-v2/[id]/receive
â”‚   â”‚   â”œâ”€ æ¨™è¨˜ç‚ºå·²æ”¶è²¨ (status: RECEIVED)
â”‚   â”‚   â”œâ”€ æ›´æ–°åº«å­˜
â”‚   â”‚   â”‚   â”œâ”€ Inventory (å…¬å¸å€‰/å€‹äººå€‰)
â”‚   â”‚   â”‚   â”œâ”€ ProductVariant.stock_quantity
â”‚   â”‚   â”‚   â””â”€ InventoryMovement (ç•°å‹•è¨˜éŒ„)
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€ è¨­å®šåˆå§‹æˆæœ¬åƒ¹
â”‚   â”‚       â””â”€ æˆæœ¬ = (å•†å“ç¸½åƒ¹ + é—œç¨…) / å¯¦æ”¶æ•¸é‡
â”‚   â”‚
â”‚   â””â”€ 4ï¸âƒ£ ã€æˆæœ¬çµç®—ã€‘POST /api/imports-v2/[id]/finalize
â”‚       â”œâ”€ è¨ˆç®—æœ€çµ‚æˆæœ¬ (å«æ‰€æœ‰å»¶å¾Œè²»ç”¨)
â”‚       â”œâ”€ æ›´æ–°å‰©é¤˜åº«å­˜æˆæœ¬
â”‚       â”œâ”€ ðŸ”„ å›žæº¯èª¿æ•´å·²å”®å•†å“æˆæœ¬èˆ‡åˆ©æ½¤
â”‚       â”œâ”€ å»ºç«‹ CostAdjustmentLog (èª¿æ•´è¨˜éŒ„)
â”‚       â””â”€ ç™¼é€é€šçŸ¥çµ¦ SUPER_ADMIN
â”‚
â”œâ”€ ðŸ“Š åº«å­˜ç®¡ç†
â”‚   â”‚
â”‚   â”œâ”€ Product (å•†å“ä¸»æª”)
â”‚   â”‚   â”œâ”€ å•†å“è³‡è¨Š (åç¨±ã€é¡žåˆ¥ã€ç”¢åœ°)
â”‚   â”‚   â””â”€ ProductVariant (å•†å“è¦æ ¼)
â”‚   â”‚       â”œâ”€ è¦æ ¼è³‡è¨Š (å®¹é‡ã€é…’ç²¾åº¦ã€å¹´ä»½)
â”‚   â”‚       â”œâ”€ stock_quantity (ç¸½åº«å­˜)
â”‚   â”‚       â”œâ”€ available_stock (å¯ç”¨åº«å­˜)
â”‚   â”‚       â””â”€ current_price (ç•¶å‰å”®åƒ¹)
â”‚   â”‚
â”‚   â”œâ”€ Inventory (ç¨ç«‹åº«å­˜è¡¨)
â”‚   â”‚   â”œâ”€ warehouse: COMPANY (å…¬å¸å€‰)
â”‚   â”‚   â”œâ”€ warehouse: PERSONAL (å€‹äººå€‰)
â”‚   â”‚   â”œâ”€ quantity (åº«å­˜æ•¸é‡)
â”‚   â”‚   â”œâ”€ available (å¯ç”¨æ•¸é‡)
â”‚   â”‚   â””â”€ cost_price (æˆæœ¬åƒ¹)
â”‚   â”‚
â”‚   â”œâ”€ InventoryMovement (åº«å­˜ç•°å‹•)
â”‚   â”‚   â”œâ”€ IMPORT (é€²è²¨) â†’ quantity_change > 0
â”‚   â”‚   â”œâ”€ SALE (éŠ·å”®) â†’ quantity_change < 0
â”‚   â”‚   â”œâ”€ TRANSFER (èª¿æ’¥)
â”‚   â”‚   â”œâ”€ ADJUSTMENT (ç›¤é»žèª¿æ•´)
â”‚   â”‚   â””â”€ é—œè¯ reference_id + reference_type
â”‚   â”‚
â”‚   â””â”€ StockTransfer (åº«å­˜èª¿æ’¥)
â”‚       â””â”€ å…¬å¸å€‰ â†” å€‹äººå€‰
â”‚
â”œâ”€ ðŸ’° éŠ·å”® â†’ å‡ºè²¨æµç¨‹
â”‚   â”‚
â”‚   â”œâ”€ 1ï¸âƒ£ ã€å ±åƒ¹å–®ã€‘Quotation (å¯é¸)
â”‚   â”‚   â”œâ”€ å»ºç«‹å ±åƒ¹
â”‚   â”‚   â”œâ”€ å®¢æˆ¶å¯©æ ¸
â”‚   â”‚   â””â”€ è½‰ç‚ºéŠ·å”®å–®
â”‚   â”‚
â”‚   â”œâ”€ 2ï¸âƒ£ ã€éŠ·å”®å–®ã€‘Sale
â”‚   â”‚   â”œâ”€ å»ºç«‹éŠ·å”®å–®
â”‚   â”‚   â”‚   â”œâ”€ é¸æ“‡å®¢æˆ¶ (Customer)
â”‚   â”‚   â”‚   â”œâ”€ é¸æ“‡å•†å“ (ProductVariant)
â”‚   â”‚   â”‚   â”œâ”€ è³‡é‡‘ä¾†æº (funding_source)
â”‚   â”‚   â”‚   â”‚   â”œâ”€ COMPANY (å…¬å¸è³‡é‡‘)
â”‚   â”‚   â”‚   â”‚   â””â”€ PERSONAL (å€‹äººè³‡é‡‘)
â”‚   â”‚   â”‚   â””â”€ SaleItem (éŠ·å”®æ˜Žç´°)
â”‚   â”‚   â”‚       â”œâ”€ quantity (æ•¸é‡)
â”‚   â”‚   â”‚       â”œâ”€ unit_price (å–®åƒ¹)
â”‚   â”‚   â”‚       â”œâ”€ cost_price (æˆæœ¬åƒ¹)
â”‚   â”‚   â”‚       â””â”€ profit (æ¯›åˆ©)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€ è¨‚å–®é¡žåž‹
â”‚   â”‚   â”‚   â”œâ”€ ä¸€èˆ¬è¨‚å–® (is_preorder: false)
â”‚   â”‚   â”‚   â””â”€ é è³¼è¨‚å–® (is_preorder: true)
â”‚   â”‚   â”‚       â”œâ”€ expected_arrival_date (é è¨ˆåˆ°è²¨æ—¥)
â”‚   â”‚   â”‚       â”œâ”€ BackorderTracking (ç¼ºè²¨è¿½è¹¤)
â”‚   â”‚   â”‚       â””â”€ åˆ°è²¨å¾Œè½‰æ­£å¼è¨‚å–®
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€ è¨‚å–®ç‹€æ…‹ (status)
â”‚   â”‚   â”‚   â”œâ”€ DRAFT (è‰ç¨¿)
â”‚   â”‚   â”‚   â”œâ”€ CONFIRMED (å·²ç¢ºèª)
â”‚   â”‚   â”‚   â”œâ”€ COMPLETED (å®Œæˆ)
â”‚   â”‚   â”‚   â””â”€ CANCELLED (å–æ¶ˆ)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€ ä»˜æ¬¾ç‹€æ…‹
â”‚   â”‚   â”‚   â”œâ”€ payment_status: UNPAID/PARTIAL/PAID
â”‚   â”‚   â”‚   â”œâ”€ is_paid: true/false
â”‚   â”‚   â”‚   â””â”€ paid_at (ä»˜æ¬¾æ™‚é–“)
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€ é‡‘é¡è¨ˆç®—
â”‚   â”‚       â”œâ”€ total_amount (ç¸½é‡‘é¡)
â”‚   â”‚       â”œâ”€ actual_amount (å¯¦æ”¶é‡‘é¡)
â”‚   â”‚       â””â”€ commission (å‚­é‡‘) â† ðŸ”’ INVESTOR çœ‹ä¸åˆ°
â”‚   â”‚
â”‚   â”œâ”€ 3ï¸âƒ£ ã€ç¢ºèªå‡ºè²¨ã€‘POST /api/sales/[id]/ship
â”‚   â”‚   â”œâ”€ æª¢æŸ¥åº«å­˜æ˜¯å¦è¶³å¤ 
â”‚   â”‚   â”œâ”€ æª¢æŸ¥æ˜¯å¦å·²ä»˜æ¬¾ (is_paid: true)
â”‚   â”‚   â”œâ”€ æ‰£æ¸›åº«å­˜
â”‚   â”‚   â”‚   â”œâ”€ Inventory.quantity -= shipped_quantity
â”‚   â”‚   â”‚   â”œâ”€ ProductVariant.stock_quantity -= shipped_quantity
â”‚   â”‚   â”‚   â””â”€ å‰µå»º InventoryMovement (SALE)
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€ æ¨™è¨˜å·²å‡ºè²¨
â”‚   â”‚
â”‚   â””â”€ 4ï¸âƒ£ ã€å‡ºè²¨å–®ã€‘ShippingOrder
â”‚       â”œâ”€ å¾žéŠ·å”®å–®å‰µå»ºå‡ºè²¨å–®
â”‚       â”‚   â””â”€ æ¢ä»¶: is_paid = true
â”‚       â”‚
â”‚       â”œâ”€ å‡ºè²¨å–®è™Ÿ: SH{æ—¥æœŸ}{åºè™Ÿ}
â”‚       â”œâ”€ ShippingItem (å‡ºè²¨æ˜Žç´°)
â”‚       â”œâ”€ å‡ºè²¨ç‹€æ…‹
â”‚       â”‚   â”œâ”€ READY (å¾…å‡ºè²¨)
â”‚       â”‚   â”œâ”€ SHIPPED (å·²å‡ºè²¨)
â”‚       â”‚   â”œâ”€ DELIVERED (å·²é€é”)
â”‚       â”‚   â””â”€ CANCELLED (å·²å–æ¶ˆ)
â”‚       â”‚
â”‚       â””â”€ âš ï¸ ç¼ºå°‘åŠŸèƒ½
â”‚           â”œâ”€ âŒ é‹è²»è¨˜éŒ„ (shipping_fee)
â”‚           â”œâ”€ âŒ åŒ…è£è²» (packaging_fee)
â”‚           â””â”€ âŒ é¡žä¼¼ ImportCost çš„è²»ç”¨ç³»çµ±
â”‚
â”œâ”€ ðŸ’³ è²¡å‹™ç®¡ç†
â”‚   â”‚
â”‚   â”œâ”€ æ‡‰æ”¶å¸³æ¬¾ (AccountsReceivable)
â”‚   â”‚   â”œâ”€ ä¾†æº: Sale
â”‚   â”‚   â”œâ”€ æ”¶æ¬¾è¨˜éŒ„: PaymentRecord
â”‚   â”‚   â””â”€ å¸³é½¡åˆ†æž
â”‚   â”‚
â”‚   â”œâ”€ æ‡‰ä»˜å¸³æ¬¾ (AccountsPayable)
â”‚   â”‚   â”œâ”€ ä¾†æº: Purchase
â”‚   â”‚   â”œâ”€ ä»˜æ¬¾è¨˜éŒ„: SupplierPayment
â”‚   â”‚   â””â”€ ä»˜æ¬¾ç‹€æ…‹è¿½è¹¤
â”‚   â”‚
â”‚   â”œâ”€ æœƒè¨ˆåˆ†éŒ„ (AccountingEntry)
â”‚   â”‚   â”œâ”€ JournalEntry (å‚³ç¥¨æ˜Žç´°)
â”‚   â”‚   â”œâ”€ å€Ÿè²¸å¹³è¡¡æª¢æŸ¥
â”‚   â”‚   â””â”€ è²¡å‹™å ±è¡¨åŸºç¤Ž
â”‚   â”‚
â”‚   â””â”€ ç¾é‡‘æµ (CashFlowRecord)
â”‚       â”œâ”€ æ”¶å…¥è¨˜éŒ„
â”‚       â”œâ”€ æ”¯å‡ºè¨˜éŒ„
â”‚       â””â”€ LINE Bot æ•´åˆ
â”‚
â”œâ”€ ðŸ“± LINE Bot æ•´åˆ
â”‚   â”‚
â”‚   â”œâ”€ ç¾é‡‘æµè¨˜éŒ„
â”‚   â”œâ”€ æˆæœ¬è©¦ç®—
â”‚   â”œâ”€ ç¨…é‡‘è¨ˆç®—
â”‚   â””â”€ Gemini AI åŠ©æ‰‹
â”‚
â”œâ”€ ðŸ“ˆ å ±è¡¨åˆ†æž
â”‚   â”‚
â”‚   â”œâ”€ å„€è¡¨æ¿ (Dashboard)
â”‚   â”‚   â”œâ”€ SUPER_ADMIN å„€è¡¨æ¿
â”‚   â”‚   â”œâ”€ INVESTOR å„€è¡¨æ¿ (å—é™)
â”‚   â”‚   â””â”€ EMPLOYEE å„€è¡¨æ¿
â”‚   â”‚
â”‚   â”œâ”€ éŠ·å”®å ±è¡¨ (Reports)
â”‚   â”‚   â”œâ”€ ç¸½è¦½å ±è¡¨
â”‚   â”‚   â”œâ”€ éŠ·å”®è¶¨å‹¢
â”‚   â”‚   â”œâ”€ å•†å“åˆ†æž
â”‚   â”‚   â”œâ”€ å®¢æˆ¶åˆ†æž
â”‚   â”‚   â””â”€ Excel åŒ¯å‡ºåŠŸèƒ½
â”‚   â”‚
â”‚   â””â”€ è²¡å‹™å ±è¡¨
â”‚       â”œâ”€ æç›Šè¡¨
â”‚       â”œâ”€ è³‡ç”¢è² å‚µè¡¨
â”‚       â””â”€ ç¾é‡‘æµé‡è¡¨
â”‚
â””â”€ âš™ï¸ ç³»çµ±ç®¡ç†
    â”‚
    â”œâ”€ ç³»çµ±è¨­å®š (SystemSetting)
    â”œâ”€ å…¬å¸è¨­å®š (CompanySettings)
    â”œâ”€ ç¨½æ ¸æ—¥èªŒ (AuditLog)
    â”œâ”€ é€šçŸ¥ç³»çµ± (Notification)
    â””â”€ è³‡æ–™åº«å¥åº·æª¢æŸ¥
```

---

## ðŸ”„ å®Œæ•´æ¥­å‹™æµç¨‹åœ–

### ðŸ“¥ é€²è²¨æµç¨‹
```
æŽ¡è³¼å–® (Purchase)
    â†“ å‰µå»º
é€²è²¨å–® (Import v2)
    â”œâ”€ è¨­å®šåŒ¯çŽ‡
    â”œâ”€ ä¸Šå‚³å ±å–®
    â””â”€ è¨˜éŒ„è²»ç”¨ (ImportCost)
    â†“ æ”¶è²¨
æ›´æ–°åº«å­˜ (Inventory + InventoryMovement)
    â”œâ”€ å…¬å¸å€‰ or å€‹äººå€‰
    â””â”€ è¨­å®šåˆå§‹æˆæœ¬
    â†“ çµç®—
æœ€çµ‚æˆæœ¬è¨ˆç®— (Finalize)
    â”œâ”€ æ›´æ–°å‰©é¤˜åº«å­˜æˆæœ¬
    â”œâ”€ å›žæº¯èª¿æ•´å·²å”®å•†å“
    â””â”€ å‰µå»ºèª¿æ•´è¨˜éŒ„
```

### ðŸ“¤ å‡ºè²¨æµç¨‹
```
å ±åƒ¹å–® (Quotation) [å¯é¸]
    â†“ è½‰æ›
éŠ·å”®å–® (Sale)
    â”œâ”€ é¸æ“‡å®¢æˆ¶ (Customer)
    â”œâ”€ é¸æ“‡å•†å“ (ProductVariant)
    â”œâ”€ è¨­å®šè³‡é‡‘ä¾†æº (COMPANY/PERSONAL)
    â””â”€ è¨ˆç®—é‡‘é¡ã€æˆæœ¬ã€åˆ©æ½¤
    â†“ ç¢ºèª
ä»˜æ¬¾ (is_paid = true)
    â””â”€ è¨˜éŒ„æ‡‰æ”¶å¸³æ¬¾ (AccountsReceivable)
    â†“ å‡ºè²¨
ç¢ºèªå‡ºè²¨ (Ship)
    â”œâ”€ æª¢æŸ¥åº«å­˜
    â”œâ”€ æ‰£æ¸›åº«å­˜ (Inventory - quantity)
    â””â”€ å‰µå»ºåº«å­˜ç•°å‹• (InventoryMovement: SALE)
    â†“ å‰µå»º
å‡ºè²¨å–® (ShippingOrder)
    â”œâ”€ å‡ºè²¨å–®è™Ÿ: SH{æ—¥æœŸ}{åºè™Ÿ}
    â”œâ”€ å‡ºè²¨æ˜Žç´° (ShippingItem)
    â””â”€ âš ï¸ ç¼ºå°‘é‹è²»/åŒ…è£è²»è¨˜éŒ„
```

### ðŸ’° è²¡å‹™æµç¨‹
```
éŠ·å”®æ”¶å…¥
    â†“
æ‡‰æ”¶å¸³æ¬¾ (AccountsReceivable)
    â”œâ”€ æ”¶æ¬¾è¨˜éŒ„ (PaymentRecord)
    â””â”€ å¸³é½¡åˆ†æž
    â†“
æœƒè¨ˆåˆ†éŒ„ (AccountingEntry)
    â””â”€ è²¡å‹™å ±è¡¨

æŽ¡è³¼æ”¯å‡º
    â†“
æ‡‰ä»˜å¸³æ¬¾ (AccountsPayable)
    â”œâ”€ ä»˜æ¬¾è¨˜éŒ„ (SupplierPayment)
    â””â”€ ä»˜æ¬¾ç‹€æ…‹è¿½è¹¤
    â†“
æœƒè¨ˆåˆ†éŒ„ (AccountingEntry)
    â””â”€ è²¡å‹™å ±è¡¨
```

---

## âš ï¸ ç›®å‰ç³»çµ±ç¼ºå£

### 1. å‡ºè²¨è²»ç”¨ç®¡ç†
```
âŒ ç¼ºå°‘åŠŸèƒ½:
   - é‹è²»è¨˜éŒ„ (shipping_fee)
   - åŒ…è£è²»è¨˜éŒ„ (packaging_fee)
   - ä¿éšªè²»è¨˜éŒ„ (insurance_fee)
   - é¡žä¼¼ ImportCost çš„ SaleCost è¡¨

âœ… å»ºè­°æ–¹æ¡ˆ:
   å‰µå»º SaleCost æˆ– ShippingCost è¡¨
   â”œâ”€ cost_type: SHIPPING | PACKAGING | INSURANCE | OTHER
   â”œâ”€ amount: è²»ç”¨é‡‘é¡
   â”œâ”€ description: è²»ç”¨æè¿°
   â””â”€ sale_id or shipping_order_id: é—œè¯éŠ·å”®å–®/å‡ºè²¨å–®
```

### 2. å‡ºè²¨å–®ç¨ç«‹æ€§
```
âš ï¸ ç›®å‰ç‹€æ³:
   - å‡ºè²¨å–®ä½¿ç”¨ Sale æ¨¡åž‹æ¨¡æ“¬
   - é€éŽ is_paid = true ç¯©é¸
   - æ²’æœ‰ç¨ç«‹çš„å‡ºè²¨ç‹€æ…‹ç®¡ç†

âœ… å·²æœ‰ ShippingOrder æ¨¡åž‹:
   - ä½†ç›®å‰æœªå®Œå…¨ä½¿ç”¨
   - å»ºè­°å®Œå…¨é·ç§»åˆ°ç¨ç«‹ ShippingOrder è¡¨
```

### 3. åº«å­˜é ç•™æ©Ÿåˆ¶
```
âŒ ç¼ºå°‘åŠŸèƒ½:
   - éŠ·å”®å–®ç¢ºèªæ™‚é ç•™åº«å­˜
   - ProductVariant.available_stock æ›´æ–°
   - é ç•™ vs å¯¦éš›å‡ºè²¨çš„æ•¸é‡è¿½è¹¤

âœ… å»ºè­°:
   - ç¢ºèªè¨‚å–®: available_stock -= quantity (é ç•™)
   - ç¢ºèªå‡ºè²¨: stock_quantity -= quantity (å¯¦éš›æ‰£æ¸›)
   - å–æ¶ˆè¨‚å–®: available_stock += quantity (é‡‹æ”¾é ç•™)
```

---

## ðŸ“Š è³‡æ–™è¡¨é—œè¯åœ–

```
User (ä½¿ç”¨è€…)
  â”œâ”€â†’ Purchase (æŽ¡è³¼å–®)
  â”œâ”€â†’ Import (é€²è²¨å–®)
  â”œâ”€â†’ Sale (éŠ·å”®å–®)
  â””â”€â†’ CashFlowRecord (ç¾é‡‘æµ)

Customer (å®¢æˆ¶)
  â”œâ”€â†’ Sale (éŠ·å”®å–®)
  â”œâ”€â†’ Quotation (å ±åƒ¹å–®)
  â””â”€â†’ AccountsReceivable (æ‡‰æ”¶å¸³æ¬¾)

Product (å•†å“)
  â””â”€â†’ ProductVariant (è¦æ ¼)
      â”œâ”€â†’ Inventory (åº«å­˜)
      â”œâ”€â†’ PurchaseItem (æŽ¡è³¼æ˜Žç´°)
      â”œâ”€â†’ ImportItem (é€²è²¨æ˜Žç´°)
      â”œâ”€â†’ SaleItem (éŠ·å”®æ˜Žç´°)
      â””â”€â†’ InventoryMovement (åº«å­˜ç•°å‹•)

Purchase (æŽ¡è³¼å–®)
  â”œâ”€â†’ PurchaseItem (æ˜Žç´°)
  â”œâ”€â†’ Import (é€²è²¨å–®)
  â””â”€â†’ AccountsPayable (æ‡‰ä»˜å¸³æ¬¾)

Import (é€²è²¨å–®)
  â”œâ”€â†’ ImportItem (æ˜Žç´°)
  â”œâ”€â†’ ImportCost (è²»ç”¨)
  â”œâ”€â†’ CostAdjustmentLog (æˆæœ¬èª¿æ•´)
  â””â”€â†’ InventoryMovement (åº«å­˜ç•°å‹•)

Sale (éŠ·å”®å–®)
  â”œâ”€â†’ SaleItem (æ˜Žç´°)
  â”œâ”€â†’ ShippingOrder (å‡ºè²¨å–®)
  â”œâ”€â†’ AccountsReceivable (æ‡‰æ”¶å¸³æ¬¾)
  â”œâ”€â†’ BackorderTracking (ç¼ºè²¨è¿½è¹¤)
  â””â”€â†’ InventoryMovement (åº«å­˜ç•°å‹•)
```

---

## ðŸŽ¯ æ¬Šé™ç®¡ç†

```
SUPER_ADMIN (è¶…ç´šç®¡ç†å“¡)
  â”œâ”€ âœ… å…¨éƒ¨åŠŸèƒ½
  â”œâ”€ âœ… çœ‹åˆ° actual_amount (å¯¦æ”¶é‡‘é¡)
  â”œâ”€ âœ… çœ‹åˆ° commission (å‚­é‡‘)
  â”œâ”€ âœ… çœ‹åˆ° cost_price (æˆæœ¬åƒ¹)
  â””â”€ âœ… çœ‹åˆ°æ‰€æœ‰è³‡é‡‘ä¾†æº (COMPANY + PERSONAL)

EMPLOYEE (å“¡å·¥)
  â”œâ”€ âœ… åŸºæœ¬ç‡Ÿé‹åŠŸèƒ½
  â”œâ”€ âœ… çœ‹åˆ° actual_amount
  â”œâ”€ âœ… çœ‹åˆ° commission
  â”œâ”€ âœ… çœ‹åˆ° cost_price
  â””â”€ âœ… çœ‹åˆ°æ‰€æœ‰è³‡é‡‘ä¾†æº

INVESTOR (æŠ•è³‡æ–¹)
  â”œâ”€ âŒ åªèƒ½çœ‹ COMPANY è³‡é‡‘ä¾†æº
  â”œâ”€ âŒ çœ‹ä¸åˆ° actual_amount
  â”œâ”€ âŒ çœ‹ä¸åˆ° commission
  â”œâ”€ âŒ çœ‹ä¸åˆ° cost_price
  â””â”€ âœ… å¯æŸ¥çœ‹å ±è¡¨ï¼ˆå—é™æ•¸æ“šï¼‰
```

---

**ç”Ÿæˆæ™‚é–“**: 2025-10-08
**ç³»çµ±ç‰ˆæœ¬**: v2 (imports v2 é·ç§»å®Œæˆ)
