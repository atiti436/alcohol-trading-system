# 🐜 螞蟻任務分割表

## 📋 **Claude Pro 友善的任務分割**

### **Phase 1: Room-1 基礎架構 (細分版)**
**螞蟻配置**: 2隻螞蟻 (1監督 + 1實作)

#### **🔐 Task 1.1: NextAuth.js 登入設定**
**預估時間**: 2-3天
**Token消耗**: ~5000 tokens
**具體任務**:
- [ ] 安裝和設定 NextAuth.js
- [ ] 配置 Google OAuth Provider
- [ ] 建立登入/登出頁面
- [ ] 測試登入流程

**交付物**:
- `/api/auth/` 相關檔案
- 登入頁面組件
- 測試截圖

---

#### **👥 Task 1.2: 使用者資料模型**
**預估時間**: 1-2天
**Token消耗**: ~3000 tokens
**具體任務**:
- [ ] 設計 User schema (Prisma)
- [ ] 建立角色枚舉 (SUPER_ADMIN, INVESTOR, EMPLOYEE)
- [ ] 使用者CRUD API

**交付物**:
- `schema.prisma` 使用者相關部分
- `/api/users/` API檔案

---

#### **🔒 Task 1.3: 權限中間件**
**預估時間**: 2-3天
**Token消耗**: ~4000 tokens
**具體任務**:
- [ ] 建立權限檢查中間件
- [ ] 實作角色驗證邏輯
- [ ] JWT token 處理

**交付物**:
- `middleware/auth.ts`
- `utils/permissions.ts`
- 權限測試案例

---

#### **🚫 Task 1.4: 投資方數據過濾**
**預估時間**: 3-4天 ⚠️ 最關鍵
**Token消耗**: ~6000 tokens
**具體任務**:
- [ ] 設計數據過濾邏輯
- [ ] 實作API回應過濾
- [ ] 確保敏感資料隔離

**重要提醒**: 這是核心安全功能！
**交付物**:
- `utils/data-filter.ts`
- 過濾邏輯測試
- 安全性驗證報告

---

#### **🏠 Task 1.5: 超級管理員首頁**
**預估時間**: 2-3天
**Token消耗**: ~4000 tokens
**具體任務**:
- [ ] 營運數據聚合API
- [ ] 儀表板組件設計
- [ ] 快速操作按鈕

**交付物**:
- `/pages/dashboard.tsx`
- 相關組件檔案
- 樣式檔案

---

#### **💼 Task 1.6: 投資方首頁**
**預估時間**: 2-3天
**Token消耗**: ~4000 tokens
**具體任務**:
- [ ] 受限數據聚合API
- [ ] 投資方專用儀表板
- [ ] 確保數據隔離

**交付物**:
- 投資方儀表板組件
- 數據隔離驗證

---

#### **👷 Task 1.7: 員工首頁**
**預估時間**: 1-2天
**Token消耗**: ~3000 tokens
**具體任務**:
- [ ] 基本操作介面
- [ ] 待辦事項顯示

**交付物**:
- 員工儀表板組件

---

### **🐜 螞蟻分工建議**

#### **螞蟻1 (監督者) 工作內容**:
```
Daily Tasks:
- 檢查螞蟻2的代碼品質
- 驗證數據隔離是否正確
- 測試權限控制
- 向老闆報告進度

Weekly Tasks:
- 整合測試
- 安全性檢查
- 文檔更新
```

#### **螞蟻2 (執行者) 工作排程**:
```
Week 1:
- Task 1.1: NextAuth設定
- Task 1.2: 使用者模型

Week 2:
- Task 1.3: 權限中間件
- Task 1.4: 數據過濾 (重點!)

Week 3:
- Task 1.5: 超管首頁
- Task 1.6: 投資方首頁
- Task 1.7: 員工首頁
```

---

### **📋 螞蟻間協作流程**

#### **每日協作**:
```
1. 螞蟻2 完成一個Task
   ↓
2. 螞蟻2 寫交付報告
   ↓
3. 老闆轉給螞蟻1檢查
   ↓
4. 螞蟻1 驗收並給反饋
   ↓
5. 老闆轉告螞蟻2結果
   ↓
6. 如有問題，螞蟻2修正
   如無問題，繼續下個Task
```

#### **交付報告模板**:
```
📋 Task 1.X 完成報告

✅ 完成項目:
- [x] 功能A已實作
- [x] 功能B已測試
- [x] 文檔已更新

🔧 技術細節:
- 使用的技術: XXX
- 檔案位置: /path/to/files
- 特殊考量: XXX

🧪 測試結果:
- [x] 功能測試通過
- [x] 權限測試通過
- [x] 數據隔離驗證

❓ 需要注意:
- 可能的風險點
- 後續整合注意事項
```

---

### **⚠️ Token管理策略**

#### **預防Token不足**:
```
1. 📏 任務大小控制
   - 每個Task < 6000 tokens
   - 複雜任務拆分更細

2. 🔄 Context重設策略
   - 重要資訊寫成文檔
   - 定期重新briefing
   - 關鍵代碼存檔案

3. 📚 減少重複說明
   - 標準化交付格式
   - 模板化常用指令
   - 預設值和範例
```

#### **Token不足應對**:
```
If Token快用完:
1. 立即儲存當前進度
2. 總結已完成部分
3. 記錄下次要做的事
4. 重新開始新對話
5. 快速briefing繼續
```

---

### **🎯 成功標準**

#### **Room-1完成標準**:
- [ ] 所有7個Task都完成
- [ ] 螞蟻1驗收通過
- [ ] 三種角色都能正常登入
- [ ] 投資方數據隔離測試通過
- [ ] 代碼品質符合規範

#### **預計時間**:
- 樂觀: 3週
- 現實: 4週
- 保守: 5週

**這樣的分割對Claude Pro來說剛剛好！** ✅

---

### **Phase 2: Room-2 主檔管理**
**螞蟻配置**: 2隻螞蟻 (1監督 + 1實作)
**負責模組**: Customer + Product

---

### **Phase 3: Room-3 交易核心**
**螞蟻配置**: 2隻螞蟻 (1監督 + 1實作)
**負責模組**: Purchase + Inventory

---

### **Phase 4: Room-4 銷售財務**
**螞蟻配置**: 2隻螞蟻 (1監督 + 1實作)
**負責模組**: Sales + Accounting
**⚠️ 重點**: 雙重價格系統 + 投資方數據隔離

---

### **Phase 5: Room-5 報表分析**
**螞蟻配置**: 2隻螞蟻 (1監督 + 1實作)
**負責模組**: Report
**特色**: 圖表視覺化 + 數據過濾

---

### **Phase 6: Room-6 AI智慧助手**
**螞蟻配置**: 2隻螞蟻 (1監督 + 1實作)
**負責模組**: LineBot
**特色**: Google Gemini API + OCR辨識